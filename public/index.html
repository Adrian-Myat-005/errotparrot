<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ErrotParrot 3.0</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

    <!-- Admin Floating Button (Hidden by default) -->
    <button id="btn-admin-float" class="admin-fab hidden" onclick="document.getElementById('modal-admin').classList.remove('hidden')">‚öôÔ∏è</button>

    <div class="app-shell">
        
        <!-- Header -->
        <header class="app-header">
            <div class="brand">
                <span class="logo-icon">ü¶ú</span>
                <div class="brand-text">
                    <h1>ErrotParrot</h1>
                    <div class="hud">
                        <span class="badge-pill">Lv.<span id="hud-lvl">1</span></span>
                        <div class="xp-track"><div id="hud-xp-bar" class="xp-fill"></div></div>
                        <span class="streak-pill">üî• <span id="hud-streak">0</span></span>
                        <span class="energy-pill">‚ö° <span id="hud-energy">5</span> <small id="hud-energy-timer" style="display:none">00:00</small></span>
                    </div>
                </div>
            </div>
            <div class="premium-nav-box">
                <span id="premium-time-left" class="premium-timer-badge hidden"></span>
                <button id="btn-premium-nav" class="btn-premium">Get Premium</button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="app-body">
            
            <!-- Screen: Lesson List -->
            <section id="screen-lessons" class="screen">
                
                <!-- Stats Row -->
                <div class="stats-overview">
                    <div class="stat-card">
                        <span class="stat-val" id="stat-completed">0</span>
                        <span class="stat-label">Lessons</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-val" id="stat-xp">0</span>
                        <span class="stat-label">Total XP</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-val" id="stat-rank">Newbie</span>
                        <span class="stat-label">Rank</span>
                    </div>
                </div>

                <!-- Teacher Bot Banner -->
                <div class="teacher-banner" onclick="startTeacherMode()">
                    <div class="teacher-icon">üë®‚Äçüè´</div>
                    <div class="teacher-info">
                        <h3>Chat with Tr. Adrian</h3>
                        <p>Real-time English Conversation</p>
                    </div>
                    <div class="teacher-arrow">‚Üí</div>
                </div>

                <div class="search-bar-sticky">
                    <input type="text" id="lesson-search" placeholder="Search 200+ lessons...">
                </div>
                
                <div class="tabs-scroll">
                    <button class="tab-btn active" data-type="all">All</button>
                    <button class="tab-btn" data-type="conversation">Conversation</button>
                    <button class="tab-btn" data-type="grammar">Grammar</button>
                    <button class="tab-btn" data-type="exam">Exams</button>
                </div>

                <div id="lesson-list" class="lesson-grid"></div>
            </section>

            <!-- Screen: Active Practice -->
            <section id="screen-active" class="screen hidden">
                <div class="active-header">
                    <button id="btn-back" class="icon-btn">‚Üê</button>
                    <div class="active-meta">
                        <h2 id="active-title">Loading...</h2>
                        <span id="active-badge" class="badge">Shadowing</span>
                    </div>
                </div>

                <!-- Chat Mode View -->
                <div id="chat-box" class="chat-viewport hidden">
                    <div id="chat-list" class="chat-list"></div>
                    <div id="ai-typing" class="typing-indicator hidden">AI is typing...</div>
                </div>

                <!-- Shadow Mode View -->
                <div id="shadow-box" class="shadow-viewport hidden">
                    <div class="card-shadow">
                        <h3 id="active-role">ROLE A</h3>
                        <p id="shadow-text">...</p>
                    </div>
                </div>

                <!-- Grammar/Reading Mode View -->
                <div id="grammar-box" class="grammar-viewport hidden">
                    <div class="grammar-content">
                        <div id="grammar-notes" class="notes-area"></div>
                        <div id="grammar-quiz" class="quiz-area hidden">
                            <h3 id="quiz-question">Question?</h3>
                            <div id="quiz-options" class="options-grid"></div>
                        </div>
                        <button id="btn-start-quiz" class="btn-secondary">Start Quick Quiz</button>
                    </div>
                </div>

                <!-- Controls -->
                <div class="active-controls-wrapper">
                    <div id="active-feedback" class="feedback-toast hidden"></div>
                    
                    <div class="control-row">
                        <button id="btn-listen" class="btn-round">üîä</button>
                        <button id="btn-record" class="btn-main">üé§ Tap to Speak</button>
                        <button id="btn-next" class="btn-main hidden">Next ‚Üí</button>
                    </div>
                    
                    <div class="settings-row hidden">
                        <div class="setting-item">
                            <label>Session: <span id="duration-display">2</span>m</label>
                            <input type="range" id="duration-slider" min="1" max="30" value="2">
                        </div>
                        <div class="setting-item">
                            <label>Tr. Adrian Starts</label>
                            <input type="checkbox" id="check-ai-starts" checked>
                        </div>
                    </div>
                </div>
            </section>

        </main>

    </div>

    <!-- Modals -->
    
    <!-- Premium Modal -->
    <div id="modal-premium" class="modal-overlay hidden">
        <div class="modal-card">
            <button class="close-modal" onclick="this.parentElement.parentElement.classList.add('hidden')">√ó</button>
            <h2>Upgrade Your Learning</h2>
            <p class="subtitle">Choose the plan that fits you.</p>

            <div class="pricing-options">
                <div class="plan-card">
                    <div class="badge-plan">POPULAR</div>
                    <h3>API License</h3>
                    <div class="price">1,000 MMK</div>
                    <p class="desc">Bring your own Groq Key. Unlimited potential.</p>
                    <ul class="features">
                        <li>‚ö° Infinite Energy</li>
                        <li>üîë Use your own API Key</li>
                        <li>üî• Heatmap Feedback</li>
                    </ul>
                    <input type="password" id="input-api-key" placeholder="Paste your Groq Key here" class="input-field">
                    <button class="btn-buy" onclick="window.open('https://t.me/Amyat604')">Get License</button>
                </div>

                <div class="plan-card featured">
                    <div class="badge-plan gold">ULTIMATE</div>
                    <h3>Pro Access</h3>
                    <div class="price">10,000 MMK</div>
                    <p class="desc">We provide the AI. Zero setup.</p>
                    <ul class="features">
                        <li>‚ö° 100 Energy / Day</li>
                        <li>üöÄ System AI Credits</li>
                        <li>üéì Priority Support</li>
                    </ul>
                    <button class="btn-buy gold" onclick="window.open('https://t.me/Amyat604')">Get Pro</button>
                </div>
            </div>

            <div class="redeem-section">
                <input type="text" id="input-redeem-code" placeholder="Enter Code (e.g. EP-1234)">
                <button id="btn-redeem-submit" class="btn-small">Unlock</button>
            </div>
        </div>
    </div>

    <!-- Ad Modal -->
    <div id="modal-ad" class="modal-overlay hidden">
        <div class="modal-card center-text">
            <h2>Unlock Lesson</h2>
            <p>Watch this short video to unlock the lesson.</p>
            <div id="ad-video-container" class="video-placeholder">
                <!-- YouTube Embed will go here -->
                <iframe id="ad-iframe" width="100%" height="200" src="" frameborder="0" allowfullscreen></iframe>
            </div>
            <div id="ad-timer" class="ad-countdown">30s</div>
            <button id="btn-ad-claim" class="btn-main hidden">Start Lesson</button>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="modal-admin" class="modal-overlay hidden">
        <div class="modal-card">
            <button class="close-modal" onclick="this.parentElement.parentElement.classList.add('hidden')">√ó</button>
            <h2>Admin Dashboard</h2>
            <div class="admin-tools">
                <label>Ad Video ID (YouTube):</label>
                <input type="text" id="admin-ad-url" class="input-field" placeholder="e.g. dQw4w9WgXcQ">
                <button id="btn-admin-save-ad" class="btn-secondary">Save Ad Settings</button>
                <hr>
                <select id="admin-code-type" class="input-field">
                    <option value="api-license">API License (1k)</option>
                    <option value="pro-access">Pro Access (10k)</option>
                </select>
                <button id="btn-admin-gen" class="btn-main">Generate Code</button>
                <div id="admin-result" class="code-display">...</div>
                <hr>
                <button id="btn-admin-refill" class="btn-secondary" onclick="state.userEnergy=100; updateHUD(); alert('Refilled');">Refill My Energy</button>
            </div>
        </div>
    </div>

    <!-- Level Up Modal -->
    <div id="modal-levelup" class="modal-overlay hidden">
        <div class="modal-card center-text">
            <div style="font-size:4rem;">üéâ</div>
            <h1>Level Up!</h1>
            <p>Energy Refilled!</p>
            <button class="btn-main" onclick="document.getElementById('modal-levelup').classList.add('hidden')">Continue</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>